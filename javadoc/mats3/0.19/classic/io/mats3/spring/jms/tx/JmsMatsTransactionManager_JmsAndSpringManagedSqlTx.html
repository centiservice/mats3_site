<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx (mats3 0.19.1-2022-11-13 API)</title>
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="JmsMatsTransactionManager_JmsAndSpringManagedSqlTx (mats3 0.19.1-2022-11-13 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9,"i5":9,"i6":10,"i7":10,"i8":10,"i9":9,"i10":10,"i11":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.DeferredConnectionProxyDataSourceWrapper_InfrastructureProxy.html" title="class in io.mats3.spring.jms.tx"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" target="_top">Frames</a></li>
<li><a href="JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">io.mats3.spring.jms.tx</div>
<h2 title="Class JmsMatsTransactionManager_JmsAndSpringManagedSqlTx" class="title">Class JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager_Jms.html" title="class in io.mats3.impl.jms">io.mats3.impl.jms.JmsMatsTransactionManager_Jms</a></li>
<li>
<ul class="inheritance">
<li>io.mats3.spring.jms.tx.JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html" title="interface in io.mats3.impl.jms">JmsMatsStatics</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</span>
extends <a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager_Jms.html" title="class in io.mats3.impl.jms">JmsMatsTransactionManager_Jms</a></pre>
<div class="block">Implementation of <a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.html" title="interface in io.mats3.impl.jms"><code>JmsMatsTransactionManager</code></a> that in addition to the JMS transaction keeps a Spring
 <code>PlatformTransactionManager</code> employing a JDBC DataSource for which it keeps transaction demarcation along with
 the JMS transaction, by means of <i>"Best Effort 1 Phase Commit"</i>. Note that you can choose between providing a
 DataSource, in which case this JmsMatsTransactionManager internally creates a <code>DataSourceTransactionManager</code>,
 or you can provide a <code>PlatformTransactionManager</code> employing a <code>DataSource</code> that you've created
 and employ externally (i.e. <code>DataSourceTransactionManager</code>, <code>JpaTransactionManager</code> or
 <code>HibernateTransactionManager</code>). In the case where you provide a <code>PlatformTransactionManager</code>,
 you should <i>definitely</i> wrap the DataSource employed when creating it by the method
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a>, so that you get lazy Connection fetching and so that Mats can know
 whether the SQL Connection was actually employed within a Mats Stage - this also elides the committing of an empty DB
 transaction if a Mats Stage does not actually employ a SQL Connection. Note that whether you use the wrapped
 DataSource or the non-wrapped DataSource when creating e.g. <code>JdbcTemplate</code>s does not matter, as Spring's
 <code>DataSourceUtils</code> and <code>TransactionSynchronizationManager</code> has an unwrapping strategy when retrieving the
 transactionally demarcated Connection.
 <p />
 Explanation of <i>Best Effort 1 Phase Commit</i>:
 <ol>
 <li><b>JMS transaction is entered</b> (a transactional JMS Connection is always within a transaction)
 <li>JMS Message is retrieved.
 <li><b>SQL transaction is entered</b>
 <li>Code is executed, <i>including SQL statements and production of new "outgoing" JMS Messages.</i>
 <li><b>SQL transaction is committed - <font color="red">Any errors also rollbacks the JMS Transaction, so that none
 of them have happened.</font></b>
 <li><b>JMS transaction is committed.</b>
 </ol>
 Out of that order, one can see that if SQL transaction becomes committed, and then the JMS transaction fails, this
 will be a pretty bad situation. However, of those two transactions, the SQL transaction is absolutely most likely to
 fail, as this is where you can have business logic failures, concurrency problems (e.g. MS SQL's "Deadlock Victim"),
 integrity constraints failing etc - that is, failures in both logic and timing. On the other hand, the JMS
 transaction (which effectively boils down to <i>"yes, I received this message, and sent these"</i>) is much harder to
 fail, where the only situation where it can fail is due to infrastructure/hardware failures (exploding server / full
 disk on Message Broker). This is called "Best Effort 1PC", and is nicely explained in <a href=
 "http://www.javaworld.com/article/2077963/open-source-tools/distributed-transactions-in-spring--with-and-without-xa.html?page=2">
 this article</a>. If this failure occurs, it will be caught and logged on ERROR level (by
 <a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager_Jms.html" title="class in io.mats3.impl.jms"><code>JmsMatsTransactionManager_Jms</code></a>) - and then the Message Broker will probably try to redeliver the message. Also
 read the <a href="http://activemq.apache.org/should-i-use-xa.html">Should I use XA Transactions</a> from Apache
 Active MQ.
 <p />
 Wise tip when working with <i>Message Oriented Middleware</i>: Code idempotent! Handle double-deliveries!
 <p />
 The transactionally demarcated SQL Connection can be retrieved from within Mats Stage lambda code user code using
 <a href="../../../../../io/mats3/MatsEndpoint.ProcessContext.html#getAttribute-java.lang.Class-java.lang.String...-"><code>ProcessContext.getAttribute(Connection.class)</code></a> - which also is
 available using <a href="../../../../../io/mats3/MatsFactory.ContextLocal.html#getAttribute-java.lang.Class-java.lang.String...-"><code>ContextLocal.getAttribute(Connection.class)</code></a>.
 <b>Notice:</b> In a Spring context, you can also get the transactionally demarcated thread-bound Connection via
 <code>DataSourceUtils.getConnection(dataSource)</code> - this is indeed what
 Spring's JDBC Template and friends are doing. <b>If you go directly to the DataSource, you will get a new Connection
 not participating in the transaction!</b> This "feature" might sometimes be of interest if you want something to be
 performed regardless of whether the stage processing fails or not. <i>(However, if you do such a thing, you must
 remember the built-in retry mechanism JMS Message Brokers has: If something fails, whatever database changes you
 performed successfully with such a non-tx-managed Connection will not participate in the rollback, and will already
 have been performed when the message is retried. This might, or might not, be what you want.).</i></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.DeferredConnectionProxyDataSourceWrapper_InfrastructureProxy.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.DeferredConnectionProxyDataSourceWrapper_InfrastructureProxy</a></span></code>
<div class="block">Extension of <a href="../../../../../io/mats3/util/wrappers/DeferredConnectionProxyDataSourceWrapper.html" title="class in io.mats3.util.wrappers"><code>DeferredConnectionProxyDataSourceWrapper</code></a> which implements <code>InfrastructureProxy</code>.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="nested.classes.inherited.from.class.io.mats3.impl.jms.JmsMatsTransactionManager_Jms">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from class&nbsp;io.mats3.impl.jms.<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager_Jms.html" title="class in io.mats3.impl.jms">JmsMatsTransactionManager_Jms</a></h3>
<code><a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager_Jms.TransactionalContext_Jms.html" title="class in io.mats3.impl.jms">JmsMatsTransactionManager_Jms.TransactionalContext_Jms</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="nested.classes.inherited.from.class.io.mats3.impl.jms.JmsMatsTransactionManager">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from interface&nbsp;io.mats3.impl.jms.<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager</a></h3>
<code><a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.ProcessingLambda.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.ProcessingLambda</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.TransactionContext.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.TransactionContext</a></code></li>
</ul>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#CONTEXT_LOCAL_KEY_CONNECTION_EMPLOYED_STATE_SUPPLIER">CONTEXT_LOCAL_KEY_CONNECTION_EMPLOYED_STATE_SUPPLIER</a></span></code>
<div class="block">A <code>Supplier&lt;Boolean&gt;</code> bound to <a href="../../../../../io/mats3/MatsFactory.ContextLocal.html" title="class in io.mats3"><code>MatsFactory.ContextLocal</code></a> when inside a Mats-transactional
 demarcation.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields.inherited.from.class.io.mats3.impl.jms.JmsMatsStatics">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;io.mats3.impl.jms.<a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html" title="interface in io.mats3.impl.jms">JmsMatsStatics</a></h3>
<code><a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#EXTRA_GRACE_MILLIS">EXTRA_GRACE_MILLIS</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#ILLEGAL_CALL_FLOWS">ILLEGAL_CALL_FLOWS</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#JMS_MSG_PROP_AUDIT">JMS_MSG_PROP_AUDIT</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#JMS_MSG_PROP_DISPATCH_TYPE">JMS_MSG_PROP_DISPATCH_TYPE</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#JMS_MSG_PROP_FROM">JMS_MSG_PROP_FROM</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#JMS_MSG_PROP_INITIALIZING_APP">JMS_MSG_PROP_INITIALIZING_APP</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#JMS_MSG_PROP_INITIATOR_ID">JMS_MSG_PROP_INITIATOR_ID</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#JMS_MSG_PROP_MATS_MESSAGE_ID">JMS_MSG_PROP_MATS_MESSAGE_ID</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#JMS_MSG_PROP_MESSAGE_TYPE">JMS_MSG_PROP_MESSAGE_TYPE</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#JMS_MSG_PROP_TO">JMS_MSG_PROP_TO</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#JMS_MSG_PROP_TRACE_ID">JMS_MSG_PROP_TRACE_ID</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MAX_STACK_HEIGHT">MAX_STACK_HEIGHT</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MAX_TOTAL_CALL_NUMBER">MAX_TOTAL_CALL_NUMBER</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MDC_MATS_APP_NAME">MDC_MATS_APP_NAME</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MDC_MATS_APP_VERSION">MDC_MATS_APP_VERSION</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MDC_MATS_CALL_NUMBER">MDC_MATS_CALL_NUMBER</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MDC_MATS_IN_MESSAGE_SYSTEM_ID">MDC_MATS_IN_MESSAGE_SYSTEM_ID</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MDC_MATS_INIT">MDC_MATS_INIT</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MDC_MATS_OUT_MATS_MESSAGE_ID">MDC_MATS_OUT_MATS_MESSAGE_ID</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MDC_MATS_STAGE">MDC_MATS_STAGE</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MDC_MATS_STAGE_ID">MDC_MATS_STAGE_ID</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#MDC_TRACE_ID">MDC_TRACE_ID</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#NO_INVOCATION_POINT">NO_INVOCATION_POINT</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#RANDOM_ALPHABET">RANDOM_ALPHABET</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#THREAD_PREFIX">THREAD_PREFIX</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#TOTAL_JMS_MSG_PROPS_SIZE">TOTAL_JMS_MSG_PROPS_SIZE</a></code></li>
</ul>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-javax.sql.DataSource-">create</a></span>(javax.sql.DataSource&nbsp;dataSource)</code>
<div class="block"><b>Simplest, recommended if you do not need the PlatformTransactionManager in your Spring context!</b> - However,
 if you need the PlatformTransaction manager in the Spring context, then make it externally (typically using a
 @Bean annotated method, <i> and make sure to wrap the contained DataSource first with
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a></i>), and use the factory method
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-org.springframework.transaction.PlatformTransactionManager-"><code>create(PlatformTransactionManager)</code></a> (it will find the DataSource from the PlatformTransactionManager by
 introspection).</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-javax.sql.DataSource-java.util.function.Function-">create</a></span>(javax.sql.DataSource&nbsp;dataSource,
      java.util.function.Function&lt;<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>,org.springframework.transaction.support.DefaultTransactionDefinition&gt;&nbsp;transactionDefinitionFunction)</code>
<div class="block">Creates an internal <code>DataSourceTransactionManager</code> for this created JmsMatsTransactionManager, and ensures
 that the supplied <code>DataSource</code> is wrapped using the <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a>
 method.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-org.springframework.transaction.PlatformTransactionManager-">create</a></span>(org.springframework.transaction.PlatformTransactionManager&nbsp;platformTransactionManager)</code>
<div class="block"><b>Next simplest, recommended if you also need the PlatformTransactionManager in your Spring context!</b>
 (otherwise, use the <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-javax.sql.DataSource-"><code>create(DataSource)</code></a> factory method).</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-org.springframework.transaction.PlatformTransactionManager-javax.sql.DataSource-">create</a></span>(org.springframework.transaction.PlatformTransactionManager&nbsp;platformTransactionManager,
      javax.sql.DataSource&nbsp;dataSource)</code>
<div class="block">Creates a <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx"><code>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</code></a> from a provided
 <code>PlatformTransactionManager</code> (of a type which manages a DataSource) - Do note that you should preferably
 have the <code>DataSource</code> within the <code><code>PlatformTransactionManager</code></code> wrapped using the
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a> method.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-org.springframework.transaction.PlatformTransactionManager-javax.sql.DataSource-java.util.function.Function-">create</a></span>(org.springframework.transaction.PlatformTransactionManager&nbsp;platformTransactionManager,
      javax.sql.DataSource&nbsp;dataSource,
      java.util.function.Function&lt;<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>,org.springframework.transaction.support.DefaultTransactionDefinition&gt;&nbsp;transactionDefinitionFunction)</code>
<div class="block">Creates a <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx"><code>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</code></a> from a provided
 <code>PlatformTransactionManager</code> (of a type which manages a DataSource) - Do note that you should preferably
 have the <code>DataSource</code> within the <code><code>PlatformTransactionManager</code></code> wrapped using the
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a> method.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>static <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-org.springframework.transaction.PlatformTransactionManager-java.util.function.Function-">create</a></span>(org.springframework.transaction.PlatformTransactionManager&nbsp;platformTransactionManager,
      java.util.function.Function&lt;<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>,org.springframework.transaction.support.DefaultTransactionDefinition&gt;&nbsp;transactionDefinitionFunction)</code>
<div class="block">Creates an instance of this class from a provided <code>PlatformTransactionManager</code> (of a type which manages a
 DataSource), where the supplied instance is introspected to find a method <code>getDataSource()</code> from where
 to get the underlying DataSource.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>javax.sql.DataSource</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#getDataSource--">getDataSource</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>javax.sql.DataSource</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#getDataSourceUnwrapped--">getDataSourceUnwrapped</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>org.springframework.transaction.PlatformTransactionManager</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#getPlatformTransactionManager--">getPlatformTransactionManager</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>static java.util.function.Function&lt;<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>,org.springframework.transaction.support.DefaultTransactionDefinition&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#getStandardTransactionDefinitionFunctionFor-java.lang.Class-">getStandardTransactionDefinitionFunctionFor</a></span>(java.lang.Class&lt;? extends org.springframework.transaction.PlatformTransactionManager&gt;&nbsp;platformTransactionManager)</code>
<div class="block">Returns the standard TransactionDefinition Function for the supplied PlatformTransactionManager.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code><a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.TransactionContext.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.TransactionContext</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#getTransactionContext-io.mats3.impl.jms.JmsMatsTransactionManager.JmsMatsTxContextKey-">getTransactionContext</a></span>(<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>&nbsp;txContextKey)</code>
<div class="block">Provides an implementation of <a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.TransactionContext.html" title="interface in io.mats3.impl.jms"><code>JmsMatsTransactionManager.TransactionContext</code></a>.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>static javax.sql.DataSource</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-">wrapLazyConnectionDatasource</a></span>(javax.sql.DataSource&nbsp;targetDataSource)</code>
<div class="block">Creates a proxy/wrapper that has lazy connection getting, and monitoring of whether the connection was actually
 retrieved.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.io.mats3.impl.jms.JmsMatsTransactionManager_Jms">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;io.mats3.impl.jms.<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager_Jms.html" title="class in io.mats3.impl.jms">JmsMatsTransactionManager_Jms</a></h3>
<code><a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager_Jms.html#create--">create</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.io.mats3.impl.jms.JmsMatsStatics">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;io.mats3.impl.jms.<a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html" title="interface in io.mats3.impl.jms">JmsMatsStatics</a></h3>
<code><a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#createFlowId-long-">createFlowId</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#getInvocationPoint--">getInvocationPoint</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#handleIncomingMessageMatsObject-io.mats3.serial.MatsSerializer-java.lang.Class-Z-">handleIncomingMessageMatsObject</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#handleIncomingState-io.mats3.serial.MatsSerializer-java.lang.Class-io.mats3.serial.MatsTrace.StackState-">handleIncomingState</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#id-java.lang.Object-">id</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#id-java.lang.String-java.lang.Object-">id</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#idThis--">idThis</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#ms3-double-">ms3</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#produceAndSendMsgSysMessages-org.slf4j.Logger-io.mats3.impl.jms.JmsMatsJmsSessionHandler.JmsSessionHolder-io.mats3.impl.jms.JmsMatsFactory-java.util.List-">produceAndSendMsgSysMessages</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#randomString-int-">randomString</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#setConcurrencyWithLog-org.slf4j.Logger-java.lang.String-java.util.function.Supplier-java.util.function.Supplier-java.util.function.Consumer-int-">setConcurrencyWithLog</a>, <a href="../../../../../io/mats3/impl/jms/JmsMatsStatics.html#stageOrInit-io.mats3.impl.jms.JmsMatsTransactionManager.JmsMatsTxContextKey-">stageOrInit</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="CONTEXT_LOCAL_KEY_CONNECTION_EMPLOYED_STATE_SUPPLIER">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CONTEXT_LOCAL_KEY_CONNECTION_EMPLOYED_STATE_SUPPLIER</h4>
<pre>public static final&nbsp;java.lang.String CONTEXT_LOCAL_KEY_CONNECTION_EMPLOYED_STATE_SUPPLIER</pre>
<div class="block">A <code>Supplier&lt;Boolean&gt;</code> bound to <a href="../../../../../io/mats3/MatsFactory.ContextLocal.html" title="class in io.mats3"><code>MatsFactory.ContextLocal</code></a> when inside a Mats-transactional
 demarcation.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#io.mats3.spring.jms.tx.JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.CONTEXT_LOCAL_KEY_CONNECTION_EMPLOYED_STATE_SUPPLIER">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="create-javax.sql.DataSource-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>create</h4>
<pre>public static&nbsp;<a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a>&nbsp;create(javax.sql.DataSource&nbsp;dataSource)</pre>
<div class="block"><b>Simplest, recommended if you do not need the PlatformTransactionManager in your Spring context!</b> - However,
 if you need the PlatformTransaction manager in the Spring context, then make it externally (typically using a
 @Bean annotated method, <i> and make sure to wrap the contained DataSource first with
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a></i>), and use the factory method
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-org.springframework.transaction.PlatformTransactionManager-"><code>create(PlatformTransactionManager)</code></a> (it will find the DataSource from the PlatformTransactionManager by
 introspection).
 <p />
 Creates an internal <code>DataSourceTransactionManager</code> for this created JmsMatsTransactionManager, and ensures
 that the supplied <code>DataSource</code> is wrapped using the <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a>
 method. Also with this way to construct the instance, Mats will know whether the stage or initiation actually
 performed any SQL data access.
 <p />
 Uses a default <code>TransactionDefinition</code> Function, which sets the transaction name, sets Isolation Level to
 <code>TransactionDefinition.ISOLATION_READ_COMMITTED</code>, and sets Propagation Behavior to
 <code>TransactionDefinition.PROPAGATION_REQUIRES_NEW</code>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataSource</code> - the DataSource to make a <code>DataSourceTransactionManager</code> from - which will be wrapped using
            <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a> if it not already is.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a new <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx"><code>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</code></a>.</dd>
</dl>
</li>
</ul>
<a name="create-javax.sql.DataSource-java.util.function.Function-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>create</h4>
<pre>public static&nbsp;<a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a>&nbsp;create(javax.sql.DataSource&nbsp;dataSource,
                                                                        java.util.function.Function&lt;<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>,org.springframework.transaction.support.DefaultTransactionDefinition&gt;&nbsp;transactionDefinitionFunction)</pre>
<div class="block">Creates an internal <code>DataSourceTransactionManager</code> for this created JmsMatsTransactionManager, and ensures
 that the supplied <code>DataSource</code> is wrapped using the <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a>
 method. Also with this way to construct the instance, Mats will know whether the stage or initiation actually
 performed any SQL data access.
 <p />
 Uses the supplied <code>TransactionDefinition</code> Function to define the transactions - consider
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-javax.sql.DataSource-"><code>create(DataSource)</code></a> if you are OK with the standard.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataSource</code> - the DataSource to make a <code>DataSourceTransactionManager</code> from - which will be wrapped using
            <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a> if it not already is.</dd>
<dd><code>transactionDefinitionFunction</code> - a <code>Function</code> which returns a <code>DefaultTransactionDefinition</code>, possibly based on the
            provided <code>JmsMatsTxContextKey</code> (e.g. different isolation level for a special endpoint).</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a new <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx"><code>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</code></a>.</dd>
</dl>
</li>
</ul>
<a name="create-org.springframework.transaction.PlatformTransactionManager-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>create</h4>
<pre>public static&nbsp;<a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a>&nbsp;create(org.springframework.transaction.PlatformTransactionManager&nbsp;platformTransactionManager)</pre>
<div class="block"><b>Next simplest, recommended if you also need the PlatformTransactionManager in your Spring context!</b>
 (otherwise, use the <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-javax.sql.DataSource-"><code>create(DataSource)</code></a> factory method). Creates an instance of this class from a
 provided <code>PlatformTransactionManager</code> (of a type which manages a DataSource), where the supplied instance
 is introspected to find a method <code>getDataSource()</code> from where to get the underlying DataSource. <b>Do
 note that you should preferably have the <code>DataSource</code> within the
 <code><code>PlatformTransactionManager</code></code> wrapped using the
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a> method.</b> If not wrapped as such, Mats will not be able to
 know whether the stage or initiation actually performed data access.
 <p />
 Uses the standard <code>TransactionDefinition</code> Function, which sets the transaction name, sets Isolation Level
 to <code>TransactionDefinition.ISOLATION_READ_COMMITTED</code> (unless HibernateTxMgr), and sets Propagation Behavior
 to <code>TransactionDefinition.PROPAGATION_REQUIRES_NEW</code> - see
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#getStandardTransactionDefinitionFunctionFor-java.lang.Class-"><code>getStandardTransactionDefinitionFunctionFor(Class)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>platformTransactionManager</code> - the <code>DataSourceTransactionManager</code> to use for transaction management.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a new <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx"><code>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</code></a>.</dd>
</dl>
</li>
</ul>
<a name="create-org.springframework.transaction.PlatformTransactionManager-java.util.function.Function-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>create</h4>
<pre>public static&nbsp;<a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a>&nbsp;create(org.springframework.transaction.PlatformTransactionManager&nbsp;platformTransactionManager,
                                                                        java.util.function.Function&lt;<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>,org.springframework.transaction.support.DefaultTransactionDefinition&gt;&nbsp;transactionDefinitionFunction)</pre>
<div class="block">Creates an instance of this class from a provided <code>PlatformTransactionManager</code> (of a type which manages a
 DataSource), where the supplied instance is introspected to find a method <code>getDataSource()</code> from where
 to get the underlying DataSource. <b>Do note that you should preferably have the <code>DataSource</code> within the
 <code><code>PlatformTransactionManager</code></code> wrapped using the
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a> method.</b> If not wrapped as such, Mats will not be able to
 know whether the stage or initiation actually performed data access.
 <p />
 Uses the supplied <code>TransactionDefinition</code> Function to define the transactions - consider
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-org.springframework.transaction.PlatformTransactionManager-"><code>create(PlatformTransactionManager)</code></a> if you are OK with the standard.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>platformTransactionManager</code> - the <code>DataSourceTransactionManager</code> to use for transaction management.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a new <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx"><code>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</code></a>.</dd>
</dl>
</li>
</ul>
<a name="create-org.springframework.transaction.PlatformTransactionManager-javax.sql.DataSource-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>create</h4>
<pre>public static&nbsp;<a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a>&nbsp;create(org.springframework.transaction.PlatformTransactionManager&nbsp;platformTransactionManager,
                                                                        javax.sql.DataSource&nbsp;dataSource)</pre>
<div class="block">Creates a <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx"><code>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</code></a> from a provided
 <code>PlatformTransactionManager</code> (of a type which manages a DataSource) - Do note that you should preferably
 have the <code>DataSource</code> within the <code><code>PlatformTransactionManager</code></code> wrapped using the
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a> method. If not wrapped as such, Mats will not be able to know
 whether the stage or initiation actually performed data access.
 <p />
 <b>Note: Only use this method if the variants NOT taking a DataSource fails to work.</b> It is imperative that
 the DataSource and the PlatformTransactionManager provided "match up", meaning that the DataSource provided is
 actually the instance which the PlatformTransactionManager handles.
 <p />
 Uses the standard <code>TransactionDefinition</code> Function, which sets the transaction name, sets Isolation Level
 to <code>TransactionDefinition.ISOLATION_READ_COMMITTED</code> (unless HibernateTxMgr), and sets Propagation Behavior
 to <code>TransactionDefinition.PROPAGATION_REQUIRES_NEW</code> - see
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#getStandardTransactionDefinitionFunctionFor-java.lang.Class-"><code>getStandardTransactionDefinitionFunctionFor(Class)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>platformTransactionManager</code> - the <code>DataSourceTransactionManager</code> to use for transaction management.</dd>
<dd><code>dataSource</code> - the <code>DataSource</code> which the supplied <code>PlatformTransactionManager</code> handles.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a new <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx"><code>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</code></a>.</dd>
</dl>
</li>
</ul>
<a name="create-org.springframework.transaction.PlatformTransactionManager-javax.sql.DataSource-java.util.function.Function-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>create</h4>
<pre>public static&nbsp;<a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx">JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</a>&nbsp;create(org.springframework.transaction.PlatformTransactionManager&nbsp;platformTransactionManager,
                                                                        javax.sql.DataSource&nbsp;dataSource,
                                                                        java.util.function.Function&lt;<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>,org.springframework.transaction.support.DefaultTransactionDefinition&gt;&nbsp;transactionDefinitionFunction)</pre>
<div class="block">Creates a <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx"><code>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</code></a> from a provided
 <code>PlatformTransactionManager</code> (of a type which manages a DataSource) - Do note that you should preferably
 have the <code>DataSource</code> within the <code><code>PlatformTransactionManager</code></code> wrapped using the
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a> method. If not wrapped as such, Mats will not be able to know
 whether the stage or initiation actually performed data access.
 <p />
 <b>Note: Only use this method if the variants NOT taking a DataSource fails to work.</b> It is imperative that
 the DataSource and the PlatformTransactionManager provided "match up", meaning that the DataSource provided is
 actually the instance which the PlatformTransactionManager handles.
 <p />
 Uses the supplied <code>TransactionDefinition</code> Function to define the transactions - consider
 <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-org.springframework.transaction.PlatformTransactionManager-javax.sql.DataSource-"><code>create(PlatformTransactionManager, DataSource)</code></a> if you are OK with the standard.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>platformTransactionManager</code> - the <code>PlatformTransactionManager</code> to use for transaction management (must be one employing a
            DataSource).</dd>
<dd><code>dataSource</code> - the <code>DataSource</code> which the supplied <code>PlatformTransactionManager</code> handles.</dd>
<dd><code>transactionDefinitionFunction</code> - a <code>Function</code> which returns a <code>DefaultTransactionDefinition</code>, possibly based on the
            provided <code>JmsMatsTxContextKey</code> (e.g. different isolation level for a special endpoint).</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a new <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" title="class in io.mats3.spring.jms.tx"><code>JmsMatsTransactionManager_JmsAndSpringManagedSqlTx</code></a>.</dd>
</dl>
</li>
</ul>
<a name="getStandardTransactionDefinitionFunctionFor-java.lang.Class-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStandardTransactionDefinitionFunctionFor</h4>
<pre>public static&nbsp;java.util.function.Function&lt;<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>,org.springframework.transaction.support.DefaultTransactionDefinition&gt;&nbsp;getStandardTransactionDefinitionFunctionFor(java.lang.Class&lt;? extends org.springframework.transaction.PlatformTransactionManager&gt;&nbsp;platformTransactionManager)</pre>
<div class="block">Returns the standard TransactionDefinition Function for the supplied PlatformTransactionManager. Sets Isolation
 Level to <code>ISOLATION_READ_COMMITTED</code> (unless
 HibernateTransactionManager, which does not support setting Isolation Level) and Propagation Behavior to
 <code>PROPAGATION_REQUIRES_NEW</code> - and also sets the name of the
 transaction to <code>JmsMatsTxContextKey</code>.toString().</div>
</li>
</ul>
<a name="wrapLazyConnectionDatasource-javax.sql.DataSource-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>wrapLazyConnectionDatasource</h4>
<pre>public static&nbsp;javax.sql.DataSource&nbsp;wrapLazyConnectionDatasource(javax.sql.DataSource&nbsp;targetDataSource)</pre>
<div class="block">Creates a proxy/wrapper that has lazy connection getting, and monitoring of whether the connection was actually
 retrieved. This again enables SpringJmsMats implementation to see if the SQL Connection was actually
 <i>employed</i> (i.e. a Statement was created) - not only whether we went into transactional demarcation, which a
 Mats stage <i>always</i> does. This method is internally employed with the <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#create-javax.sql.DataSource-"><code>DataSource-taking</code></a> factories of this class which makes an internal <code>DataSourceTransactionManager</code>, but
 should also be employed if you externally create another type of <code>PlatformTransactionManager</code>, e.g. the
 HibernateTransactionManager, and provide that to the factories of this class taking a PlatformTransactionManager.
 <p />
 It returns an instance of <a href="../../../../../io/mats3/util/wrappers/DeferredConnectionProxyDataSourceWrapper.html" title="class in io.mats3.util.wrappers"><code>DeferredConnectionProxyDataSourceWrapper</code></a>, but as an extension that also
 implements Spring's <code>InfrastructureProxy</code>.
 <p />
 We want this Lazy-and-Monitored DataSource which is returned here to "compare equals" with that of the DataSource
 which is supplied to us - and which might be employed by other components "on the outside" of Mats - wrt. how
 Spring's <code>DataSourceUtils</code> compare them in its ThreadLocal cache-hackery. Therefore, the proxy implement
 <code>InfrastructureProxy</code> (read its JavaDoc!), which means that Spring can trawl its way down to the actual
 DataSource when it needs to compare. Note: You will find this proxy-handling in the
 <code>TransactionSynchronizationManager.getResource(Object)</code>, which invokes
 <code>TransactionSynchronizationUtils.unwrapResourceIfNecessary(..)</code>, where the instanceof-check for
 InfraStructureProxy resides.
 <p />
 <i>"The magnitude of this hack compares favorably with that of the US-of-A's national debt."</i>
 <p />
 Note: It is not a problem if the DataSource supplied is already wrapped in a
 <code>LazyConnectionDataSourceProxy</code>, but it is completely unnecessary.
 <p />
 Tip: If you would want to check/understand how the LazyConnection stuff work, you may within a Mats stage do a
 DataSourceUtil.getConnection(dataSource) - if the returned Connection's toString() looks like
 <code>"DeferredConnectionProxy@3ec11999 WITHOUT actual Connection from DataSource@3406472c..."</code> then the
 actual Connection is still not gotten. When it is gotten (e.g. after having done a SQL CRUD operation), the
 toString() will look like <code>"DeferredConnectionProxy@3ec11999 WITH actual Connection@b5cc23a"</code></div>
</li>
</ul>
<a name="getPlatformTransactionManager--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPlatformTransactionManager</h4>
<pre>public&nbsp;org.springframework.transaction.PlatformTransactionManager&nbsp;getPlatformTransactionManager()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the employed Spring <code>PlatformTransactionManager</code>, which either was created by this instance if this
         instance was created using one of the DataSource-taking factory methods, or it was provided if this
         instance was created using one of the PlatformTransactionManager-taking methods.</dd>
</dl>
</li>
</ul>
<a name="getDataSource--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDataSource</h4>
<pre>public&nbsp;javax.sql.DataSource&nbsp;getDataSource()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the employed <code>DataSource</code>, which either was provided when creating this instance (and thus
         wrapped), or was reflected out of the provided <code>PlatformTransactionManager</code>. It is hopefully
         wrapped using the <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#wrapLazyConnectionDatasource-javax.sql.DataSource-"><code>wrapLazyConnectionDatasource(DataSource)</code></a>, which is done automatically if this
         instance was created using one of the DataSource-taking factory methods. However, if this instance was
         created using one of the PlatformTransactionManager-taking factory methods, it is up to the user to have
         wrapped it. Note that it works unwrapped too, but SpringJmsMats cannot then know whether the stages
         actually employ the SQL Connection, and must do full transaction demarcation around every stage.</dd>
</dl>
</li>
</ul>
<a name="getDataSourceUnwrapped--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDataSourceUnwrapped</h4>
<pre>public&nbsp;javax.sql.DataSource&nbsp;getDataSourceUnwrapped()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the unwrapped variant of <a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html#getDataSource--"><code>getDataSource()</code></a> - note that it is only any <code>InfrastructureProxy</code>s
         that are unwrapped; Any wrapping done by a database pool is left intact.</dd>
</dl>
</li>
</ul>
<a name="getTransactionContext-io.mats3.impl.jms.JmsMatsTransactionManager.JmsMatsTxContextKey-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getTransactionContext</h4>
<pre>public&nbsp;<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.TransactionContext.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.TransactionContext</a>&nbsp;getTransactionContext(<a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.JmsMatsTxContextKey.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager.JmsMatsTxContextKey</a>&nbsp;txContextKey)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.html#getTransactionContext-io.mats3.impl.jms.JmsMatsTransactionManager.JmsMatsTxContextKey-">JmsMatsTransactionManager</a></code></span></div>
<div class="block">Provides an implementation of <a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.TransactionContext.html" title="interface in io.mats3.impl.jms"><code>JmsMatsTransactionManager.TransactionContext</code></a>. (JMS Connection and Session handling is done by
 <a href="../../../../../io/mats3/impl/jms/JmsMatsJmsSessionHandler.html" title="interface in io.mats3.impl.jms"><code>JmsMatsJmsSessionHandler</code></a>).</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.html#getTransactionContext-io.mats3.impl.jms.JmsMatsTransactionManager.JmsMatsTxContextKey-">getTransactionContext</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.html" title="interface in io.mats3.impl.jms">JmsMatsTransactionManager</a></code></dd>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager_Jms.html#getTransactionContext-io.mats3.impl.jms.JmsMatsTransactionManager.JmsMatsTxContextKey-">getTransactionContext</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager_Jms.html" title="class in io.mats3.impl.jms">JmsMatsTransactionManager_Jms</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>txContextKey</code> - for which <a href="../../../../../io/mats3/impl/jms/JmsMatsStage.html" title="class in io.mats3.impl.jms"><code>JmsMatsStage</code></a> or <code>JmsMatsInitiator</code> this request for <a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.TransactionContext.html" title="interface in io.mats3.impl.jms"><code>JmsMatsTransactionManager.TransactionContext</code></a>
            is for.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a <a href="../../../../../io/mats3/impl/jms/JmsMatsTransactionManager.TransactionContext.html" title="interface in io.mats3.impl.jms"><code>JmsMatsTransactionManager.TransactionContext</code></a> for the supplied txContextKey.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.DeferredConnectionProxyDataSourceWrapper_InfrastructureProxy.html" title="class in io.mats3.spring.jms.tx"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?io/mats3/spring/jms/tx/JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" target="_top">Frames</a></li>
<li><a href="JmsMatsTransactionManager_JmsAndSpringManagedSqlTx.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
