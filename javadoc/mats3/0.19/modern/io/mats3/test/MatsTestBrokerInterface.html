<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>MatsTestBrokerInterface (mats3 0.19.1-2022-11-13 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: io.mats3.test, interface: MatsTestBrokerInterface">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">io.mats3.test</a></div>
<h1 title="Interface MatsTestBrokerInterface" class="title">Interface MatsTestBrokerInterface</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="MatsTestBrokerInterface.MatsTestBrokerInterface_JmsMatsFactory.html" title="class in io.mats3.test">MatsTestBrokerInterface.MatsTestBrokerInterface_JmsMatsFactory</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">MatsTestBrokerInterface</span></div>
<div class="block">Tool that makes it possible to query the underlying broker of a test MatsFactory for messages, in particular
 "residual" messages and DLQs. DLQ-fetching is useful if the test is designed to fail a stage, i.e. that a stage under
 test raises some <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/RuntimeException.html" title="class or interface in java.lang" class="external-link"><code>RuntimeException</code></a>, or the special <code>MatsRefuseMessageException</code> due to some
 internal validation performed.
 <p/>
 Usage: If employing the Mats test tools, one of these should have been created for you. For the JUnit
 <code>Rule_Mats</code>, and JUnit Jupiter <code>Extension_Mats</code>, there's a getter directly on the
 rule/extension instance. For Spring, employing the <code>@MatsTestContext</code> or corresponding
 <code>MatsTestInfrastructureConfiguration</code>, an instance is put into the Spring context for you. If you do not
 use those tools, you will have to create a instance of this class as a Spring bean yourself - either directly by
 using the <a href="#create(javax.jms.ConnectionFactory,io.mats3.MatsFactory)"><code>create(..)</code></a> methods taking parameters, or indirectly by
 using the <a href="#createForLaterPopulation()"><code>createForLaterPopulation()</code></a> variant, and rely on the <code>SpringJmsMatsFactoryWrapper</code>
 finding it from the Spring context and populating it for you.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Interface</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="MatsTestBrokerInterface.MatsMessageRepresentation.html" class="type-name-link" title="interface in io.mats3.test">MatsTestBrokerInterface.MatsMessageRepresentation</a></code></div>
<div class="col-last even-row-color">
<div class="block">Representation of the Mats message that sat on the DLQ.</div>
</div>
<div class="col-first odd-row-color"><code>static class&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="MatsTestBrokerInterface.MatsTestBrokerInterface_JmsMatsFactory.html" class="type-name-link" title="class in io.mats3.test">MatsTestBrokerInterface.MatsTestBrokerInterface_JmsMatsFactory</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="MatsTestBrokerInterface.html" title="interface in io.mats3.test">MatsTestBrokerInterface</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#_latePopulate(javax.jms.ConnectionFactory,io.mats3.MatsFactory)" class="member-name-link">_latePopulate</a><wbr>(javax.jms.ConnectionFactory&nbsp;connectionFactory,
 <a href="../MatsFactory.html" title="interface in io.mats3">MatsFactory</a>&nbsp;matsFactory)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block"><i>This method is most probably not for you!</i>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1"><code>static <a href="MatsTestBrokerInterface.html" title="interface in io.mats3.test">MatsTestBrokerInterface</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1"><code><a href="#create(javax.jms.ConnectionFactory,io.mats3.MatsFactory)" class="member-name-link">create</a><wbr>(javax.jms.ConnectionFactory&nbsp;connectionFactory,
 <a href="../MatsFactory.html" title="interface in io.mats3">MatsFactory</a>&nbsp;matsFactory)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1">
<div class="block">If you have both the JMS ConnectionFactory and a JmsMatsFactory available from start, then you can create a
 working instance right away.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1"><code>static <a href="MatsTestBrokerInterface.html" title="interface in io.mats3.test">MatsTestBrokerInterface</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1"><code><a href="#createForLaterPopulation()" class="member-name-link">createForLaterPopulation</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1">
<div class="block">Special factory variant, where the needed parameters must be supplied by
 <a href="#_latePopulate(javax.jms.ConnectionFactory,io.mats3.MatsFactory)"><code>_latePopulate(ConnectionFactory, MatsFactory)</code></a>, which typically will be handled by the
 <code>SpringJmsMatsFactoryWrapper</code>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="MatsTestBrokerInterface.MatsMessageRepresentation.html" title="interface in io.mats3.test">MatsTestBrokerInterface.MatsMessageRepresentation</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getDlqMessage(java.lang.String)" class="member-name-link">getDlqMessage</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;endpointOrStageId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Waits a couple of seconds for a message to appear on the Dead Letter Queue for the provided endpoint- or stageId
 (Queue name "DLQ."+matsendpointPrefix+endpointOrStageId) - and also checks the standard common ActiveMQ DLQ
 (Queue name "ActiveMQ.DLQ") in case the broker is not configured with specific DLQs per Queue, which is relevant
 if you fire up an unmodified ActiveMQ distribution on the command line, check the <code>MatsTestBroker</code> class
 JavaDoc for how to use an external MQ instead of the in-VM which otherwise is fired up.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="create(javax.jms.ConnectionFactory,io.mats3.MatsFactory)">
<h3>create</h3>
<div class="member-signature"><span class="modifiers">static</span>&nbsp;<span class="return-type"><a href="MatsTestBrokerInterface.html" title="interface in io.mats3.test">MatsTestBrokerInterface</a></span>&nbsp;<span class="element-name">create</span><wbr><span class="parameters">(javax.jms.ConnectionFactory&nbsp;connectionFactory,
 <a href="../MatsFactory.html" title="interface in io.mats3">MatsFactory</a>&nbsp;matsFactory)</span></div>
<div class="block">If you have both the JMS ConnectionFactory and a JmsMatsFactory available from start, then you can create a
 working instance right away. Otherwise, typically in a Spring bean context, check out
 <a href="#_latePopulate(javax.jms.ConnectionFactory,io.mats3.MatsFactory)"><code>_latePopulate(ConnectionFactory, MatsFactory)</code></a>. Note that the MatsFactory parameter currently needs to be
 a <a href="../impl/jms/JmsMatsFactory.html" title="class in io.mats3.impl.jms"><code>JmsMatsFactory</code></a> - read more at _latePopulate().</div>
</section>
</li>
<li>
<section class="detail" id="createForLaterPopulation()">
<h3>createForLaterPopulation</h3>
<div class="member-signature"><span class="modifiers">static</span>&nbsp;<span class="return-type"><a href="MatsTestBrokerInterface.html" title="interface in io.mats3.test">MatsTestBrokerInterface</a></span>&nbsp;<span class="element-name">createForLaterPopulation</span>()</div>
<div class="block">Special factory variant, where the needed parameters must be supplied by
 <a href="#_latePopulate(javax.jms.ConnectionFactory,io.mats3.MatsFactory)"><code>_latePopulate(ConnectionFactory, MatsFactory)</code></a>, which typically will be handled by the
 <code>SpringJmsMatsFactoryWrapper</code>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>an empty, not still ready instance.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getDlqMessage(java.lang.String)">
<h3>getDlqMessage</h3>
<div class="member-signature"><span class="return-type"><a href="MatsTestBrokerInterface.MatsMessageRepresentation.html" title="interface in io.mats3.test">MatsTestBrokerInterface.MatsMessageRepresentation</a></span>&nbsp;<span class="element-name">getDlqMessage</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;endpointOrStageId)</span></div>
<div class="block">Waits a couple of seconds for a message to appear on the Dead Letter Queue for the provided endpoint- or stageId
 (Queue name "DLQ."+matsendpointPrefix+endpointOrStageId) - and also checks the standard common ActiveMQ DLQ
 (Queue name "ActiveMQ.DLQ") in case the broker is not configured with specific DLQs per Queue, which is relevant
 if you fire up an unmodified ActiveMQ distribution on the command line, check the <code>MatsTestBroker</code> class
 JavaDoc for how to use an external MQ instead of the in-VM which otherwise is fired up. (NOTE: It is HIGHLY
 suggested to use the "specific DLQ" pattern in any production setting, as this is much easier to reason about
 when ugly things starts hitting fans).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>endpointOrStageId</code> - the endpoint which is expected to generate a DLQ message.</dd>
<dt>Returns:</dt>
<dd>the <a href="../serial/MatsTrace.html" title="interface in io.mats3.serial"><code>MatsTrace</code></a> of the DLQ'ed message.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="_latePopulate(javax.jms.ConnectionFactory,io.mats3.MatsFactory)">
<h3>_latePopulate</h3>
<div class="member-signature"><span class="return-type"><a href="MatsTestBrokerInterface.html" title="interface in io.mats3.test">MatsTestBrokerInterface</a></span>&nbsp;<span class="element-name">_latePopulate</span><wbr><span class="parameters">(javax.jms.ConnectionFactory&nbsp;connectionFactory,
 <a href="../MatsFactory.html" title="interface in io.mats3">MatsFactory</a>&nbsp;matsFactory)</span></div>
<div class="block"><i>This method is most probably not for you!</i>. It is employed by <code>SpringJmsMatsFactoryWrapper</code>, by
 reflection invocation when it is both on classpath and as an instance in the Spring context, to perform "late
 setting" of the properties which the tool needs to perform its job. (Reason for reflection: This class resides in
 the 'mats-test' project - which is for testing, while the <code>SpringJmsMatsFactoryWrapper</code> is in the
 'mats-spring-jms' project - which is for "production").
 <p/>
 The matsFactory parameter currently needs to be a JmsMatsFactory. We need all of the following from it
 <ul>
 <li><code>matsFactory.getFactoryConfig().getMatsDestinationPrefix()</code> (standard MatsFactory)</li>
 <li><code>matsFactory.getFactoryConfig().getMatsTraceKey()</code> (standard MatsFactory)</li>
 <li>The Mats Interceptor API (from <a href="../api/intercept/MatsInterceptable.html" title="interface in io.mats3.api.intercept"><code>MatsInterceptable</code></a>, which JmsMatsFactory is)</li>
 <li>The <a href="../serial/MatsSerializer.html" title="interface in io.mats3.serial"><code>MatsSerializer</code></a> to provide access to contents from messages (from JmsMatsFactory)</li>
 </ul>
 <p/>
 <b>Note: The MatsFactory provided may be a <a href="../MatsFactory.MatsFactoryWrapper.html" title="class in io.mats3"><code>MatsFactory.MatsFactoryWrapper</code></a>, but it must resolve to a
 <a href="../impl/jms/JmsMatsFactory.html" title="class in io.mats3.impl.jms"><code>JmsMatsFactory</code></a> via the <a href="../MatsFactory.html#unwrapFully()"><code>MatsFactory.unwrapFully()</code></a>!</b> Otherwise, it'll throw an
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link"><code>IllegalArgumentException</code></a>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd><code>this</code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
