<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>MatsStageInterceptor (mats3 0.19.9-2023-05-04 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: io.mats3.api.intercept, interface: MatsStageInterceptor">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">io.mats3.api.intercept</a></div>
<h1 title="Interface MatsStageInterceptor" class="title">Interface MatsStageInterceptor</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Known Subinterfaces:</dt>
<dd><code><a href="MatsStageInterceptor.MatsStageInterceptOutgoingMessages.html" title="interface in io.mats3.api.intercept">MatsStageInterceptor.MatsStageInterceptOutgoingMessages</a></code></dd>
</dl>
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="../../localinspect/LocalStatsMatsInterceptor.html" title="class in io.mats3.localinspect">LocalStatsMatsInterceptor</a></code>, <code><a href="../../intercept/logging/MatsMetricsLoggingInterceptor.html" title="class in io.mats3.intercept.logging">MatsMetricsLoggingInterceptor</a></code>, <code><a href="../../intercept/micrometer/MatsMicrometerInterceptor.html" title="class in io.mats3.intercept.micrometer">MatsMicrometerInterceptor</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">MatsStageInterceptor</span></div>
<div class="block"><b>Implement this interface to intercept Stage Processing</b>, then register with
 <a href="MatsInterceptable.html#addStageInterceptor(io.mats3.api.intercept.MatsStageInterceptor)"><code>MatsInterceptable.addStageInterceptor(MatsStageInterceptor)</code></a>.
 <p/>
 Intercepts stage processors with ability to modify the stage processing, and implement extra logging and metrics
 gathering.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Interface</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="MatsStageInterceptor.MatsStageInterceptOutgoingMessages.html" class="type-name-link" title="interface in io.mats3.api.intercept">MatsStageInterceptor.MatsStageInterceptOutgoingMessages</a></code></div>
<div class="col-last even-row-color">
<div class="block">While still within the stage process context, this interception enables modifying outgoing messages from the user
 lambda, setting trace properties, adding "sideloads", deleting a message, or initiating additional messages.</div>
</div>
<div class="col-first odd-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="MatsStageInterceptor.MatsStageInterceptUserLambda.html" class="type-name-link" title="interface in io.mats3.api.intercept">MatsStageInterceptor.MatsStageInterceptUserLambda</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Enables the intercepting of the invocation of the "user lambda" in a Stage, with ability to wrap the
 <a href="../../MatsEndpoint.ProcessContext.html" title="interface in io.mats3"><code>MatsEndpoint.ProcessContext</code></a> (and thus modify any reply, request, next or initiations) and/or modifying state and
 message - or even take over the entire stage.</div>
</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="MatsStageInterceptor.StageCommonContext.html" class="type-name-link" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageCommonContext</a></code></div>
<div class="col-last even-row-color">
<div class="block">Common context elements for stage interception, including all the incoming message/envelope data and metadata.</div>
</div>
<div class="col-first odd-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="MatsStageInterceptor.StageCompletedContext.html" class="type-name-link" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageCompletedContext</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="MatsStageInterceptor.StageInterceptContext.html" class="type-name-link" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageInterceptContext</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="MatsStageInterceptor.StageInterceptOutgoingMessageContext.html" class="type-name-link" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageInterceptOutgoingMessageContext</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="MatsStageInterceptor.StageInterceptUserLambdaContext.html" class="type-name-link" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageInterceptUserLambdaContext</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="MatsStageInterceptor.StagePreprocessAndDeserializeErrorContext.html" class="type-name-link" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StagePreprocessAndDeserializeErrorContext</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="MatsStageInterceptor.StageReceivedContext.html" class="type-name-link" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageReceivedContext</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab5" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab5', 3)" class="table-tab">Default Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code>default void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code><a href="#stageCompleted(io.mats3.api.intercept.MatsStageInterceptor.StageCompletedContext)" class="member-name-link">stageCompleted</a><wbr>(<a href="MatsStageInterceptor.StageCompletedContext.html" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageCompletedContext</a>&nbsp;context)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5">
<div class="block">Invoked <i>after</i> the stage is fully completed, outgoing messages sent, db and messaging system committed.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code>default void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code><a href="#stageCompletedNextDirect(io.mats3.api.intercept.MatsStageInterceptor.StageCompletedContext)" class="member-name-link">stageCompletedNextDirect</a><wbr>(<a href="MatsStageInterceptor.StageCompletedContext.html" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageCompletedContext</a>&nbsp;context)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5">
<div class="block">Special variant of <a href="#stageCompleted(io.mats3.api.intercept.MatsStageInterceptor.StageCompletedContext)"><code>stageCompleted(StageCompletedContext)</code></a> which is invoked when a
 <a href="../../MatsEndpoint.ProcessContext.html#nextDirect(java.lang.Object)"><code>MatsEndpoint.ProcessContext.nextDirect(Object)</code></a> has been performed: As opposed to the ordinary variant, this does
 <i>not</i> execute outside the stage's transactional demarcation, since the nextDirect stage processing happens
 within the same transactional demarcation as the stage which invoked nextDirect.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code>default void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code><a href="#stagePreprocessAndDeserializeError(io.mats3.api.intercept.MatsStageInterceptor.StagePreprocessAndDeserializeErrorContext)" class="member-name-link">stagePreprocessAndDeserializeError</a><wbr>(<a href="MatsStageInterceptor.StagePreprocessAndDeserializeErrorContext.html" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StagePreprocessAndDeserializeErrorContext</a>&nbsp;context)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5">
<div class="block">Invoked if any of the preprocessing and deserialization activities on the incoming message from the message
 system fails, and hence no Stage processing will be performed - i.e., no further methods of the interceptor will
 be invoked.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code>default void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code><a href="#stageReceived(io.mats3.api.intercept.MatsStageInterceptor.StageReceivedContext)" class="member-name-link">stageReceived</a><wbr>(<a href="MatsStageInterceptor.StageReceivedContext.html" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageReceivedContext</a>&nbsp;context)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5">
<div class="block">Invoked right after message have been received, preprocessed and deserialized, before invoking the user lambda.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="stagePreprocessAndDeserializeError(io.mats3.api.intercept.MatsStageInterceptor.StagePreprocessAndDeserializeErrorContext)">
<h3>stagePreprocessAndDeserializeError</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">stagePreprocessAndDeserializeError</span><wbr><span class="parameters">(<a href="MatsStageInterceptor.StagePreprocessAndDeserializeErrorContext.html" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StagePreprocessAndDeserializeErrorContext</a>&nbsp;context)</span></div>
<div class="block">Invoked if any of the preprocessing and deserialization activities on the incoming message from the message
 system fails, and hence no Stage processing will be performed - i.e., no further methods of the interceptor will
 be invoked. Conversely, this method will not be invoked in normal situations: If the normal user lambda throws,
 or database or messaging system fails, this will result in the <a href="MatsStageInterceptor.StageCompletedContext.html" title="interface in io.mats3.api.intercept"><code>MatsStageInterceptor.StageCompletedContext</code></a> of the
 <a href="#stageCompleted(io.mats3.api.intercept.MatsStageInterceptor.StageCompletedContext)"><code>stageCompleted(..)</code></a> call describe the problem and contain the
 cause, see <a href="MatsStageInterceptor.StageCompletedContext.ProcessResult.html#USER_EXCEPTION"><code>MatsStageInterceptor.StageCompletedContext.ProcessResult.USER_EXCEPTION</code></a> and <a href="MatsStageInterceptor.StageCompletedContext.ProcessResult.html#SYSTEM_EXCEPTION"><code>MatsStageInterceptor.StageCompletedContext.ProcessResult.SYSTEM_EXCEPTION</code></a>.
 <p/>
 <b>Note: This should really never be triggered. It would be prudent to "notify the humans" if it ever did.</b></div>
</section>
</li>
<li>
<section class="detail" id="stageReceived(io.mats3.api.intercept.MatsStageInterceptor.StageReceivedContext)">
<h3>stageReceived</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">stageReceived</span><wbr><span class="parameters">(<a href="MatsStageInterceptor.StageReceivedContext.html" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageReceivedContext</a>&nbsp;context)</span></div>
<div class="block">Invoked right after message have been received, preprocessed and deserialized, before invoking the user lambda.
 (If any error occurs during preprocess or deserialization, then
 <a href="#stagePreprocessAndDeserializeError(io.mats3.api.intercept.MatsStageInterceptor.StagePreprocessAndDeserializeErrorContext)"><code>stagePreprocessAndDeserializeError(StagePreprocessAndDeserializeErrorContext)</code></a> is invoked instead).</div>
</section>
</li>
<li>
<section class="detail" id="stageCompleted(io.mats3.api.intercept.MatsStageInterceptor.StageCompletedContext)">
<h3>stageCompleted</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">stageCompleted</span><wbr><span class="parameters">(<a href="MatsStageInterceptor.StageCompletedContext.html" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageCompletedContext</a>&nbsp;context)</span></div>
<div class="block">Invoked <i>after</i> the stage is fully completed, outgoing messages sent, db and messaging system committed. You
 cannot anymore modify any outgoing messages etc - for this, implement <a href="MatsStageInterceptor.MatsStageInterceptOutgoingMessages.html" title="interface in io.mats3.api.intercept"><code>MatsStageInterceptor.MatsStageInterceptOutgoingMessages</code></a>.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list-long">
<li><a href="#stageCompletedNextDirect(io.mats3.api.intercept.MatsStageInterceptor.StageCompletedContext)"><code>stageCompletedNextDirect(StageCompletedContext)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="stageCompletedNextDirect(io.mats3.api.intercept.MatsStageInterceptor.StageCompletedContext)">
<h3>stageCompletedNextDirect</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">stageCompletedNextDirect</span><wbr><span class="parameters">(<a href="MatsStageInterceptor.StageCompletedContext.html" title="interface in io.mats3.api.intercept">MatsStageInterceptor.StageCompletedContext</a>&nbsp;context)</span></div>
<div class="block">Special variant of <a href="#stageCompleted(io.mats3.api.intercept.MatsStageInterceptor.StageCompletedContext)"><code>stageCompleted(StageCompletedContext)</code></a> which is invoked when a
 <a href="../../MatsEndpoint.ProcessContext.html#nextDirect(java.lang.Object)"><code>MatsEndpoint.ProcessContext.nextDirect(Object)</code></a> has been performed: As opposed to the ordinary variant, this does
 <i>not</i> execute outside the stage's transactional demarcation, since the nextDirect stage processing happens
 within the same transactional demarcation as the stage which invoked nextDirect. Therefore, no outgoing messages
 has yet been sent, and db and message system are not yet committed.</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
